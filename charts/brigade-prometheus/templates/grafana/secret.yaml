apiVersion: v1
kind: Secret
metadata:
  name: {{ include "brigade-prometheus.grafana.fullname" . }}-config
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "brigade-prometheus.labels" . | nindent 4 }}
    {{- include "brigade-prometheus.grafana.labels" . | nindent 4 }}
stringData:
  grafana.ini: |-
    [dashboards]
    # Path to the default home dashboard. If this value is empty, then Grafana uses StaticRootPath + "dashboards/home.json"
    default_home_dashboard_path = /var/lib/grafana/dashboards/brigade.json

    {{- if .Values.grafana.auth.proxy }}
    [auth.anonymous]
    enabled = true
    
    [users]
    allow_sign_up = false
    {{- else }}
    [security]
    admin_user = {{ .Values.grafana.auth.username }}
    admin_password = {{ .Values.grafana.auth.password }}

    {{- end }}
